[pytest]
# Pytest configuration for CryptoCortex Backend tests

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Minimum Python version
minversion = 7.0

# Test paths
testpaths = tests

# Enable asyncio mode
asyncio_mode = auto

# Output options
addopts = 
    -ra
    --strict-markers
    --strict-config
    --showlocals
    --verbose

# Markers
markers =
    asyncio: mark test as asynchronous
    unit: mark test as a unit test
    integration: mark test as an integration test
    slow: mark test as slow running

# Coverage options (when using --cov)
[coverage:run]
source = routes
omit = 
    */tests/*
    */test_*.py
    */__pycache__/*
    */venv/*
    */env/*

[coverage:report]
precision = 2
show_missing = True
skip_covered = False

# Ignore common warnings
filterwarnings =
    # Catch-all: ignore all Warning subclasses (silences third-party noise)
    ignore::Warning
    # General
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

    # Pydantic / pydantic-core (v1/v2 transition noise)
    ignore::pydantic_core.core_schema.PydanticDeprecatedSince20
    ignore::DeprecationWarning:pydantic.*
    ignore::DeprecationWarning:pydantic_core.*

    # Beanie ODM (common deprecation warnings during tests)
    ignore::DeprecationWarning:beanie.*

    # Websockets library deprecation noise
    ignore::DeprecationWarning:websockets.*

    # python-binance / binance client deprecation noise
    ignore::DeprecationWarning:binance.*
    ignore::DeprecationWarning:python_binance.*

    # urllib3 InsecureRequestWarning (causes noisy test output in some HTTP tests)
    ignore:.*InsecureRequestWarning.*:urllib3.*
